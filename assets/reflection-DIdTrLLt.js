import{j as e,r as u,a as C,h as F,b as T,L as _}from"./index-AORBKq_K.js";import{m as z,M as j,c as D,z as c,T as W,O as H,A as G,a as I,N as L,f as P,b as X,F as V,d as Y,u as O,e as N,S as Z,C as A,g as q}from"./useDesmos-C-D9ibzE.js";import{R as M,F as S,a as R}from"./RadioGroup-BGX8-C2w.js";import{S as h,T as d,P as E}from"./Stack-CNDskeZF.js";import"./createSvgIcon-UFuMZq7b.js";const J=()=>{const{state:{value:r},handleChange:o,handleBlur:x}=z();return e.jsxs(M,{value:r,onChange:(m,p)=>o(p),onBlur:x,children:[e.jsx(S,{value:"horizontal",control:e.jsx(R,{}),label:e.jsx(j,{children:"แนวแกน $x$"})}),e.jsx(S,{value:"vertical",control:e.jsx(R,{}),label:e.jsx(j,{children:"แนวแกน $y$"})}),e.jsx(S,{value:"linear",control:e.jsx(R,{}),label:"สมการเส้นตรง"})]})},g=c.string().trim().normalize().nonempty().refine(r=>!isNaN(Number(r))).pipe(c.transform(r=>Number(r))),w=c.discriminatedUnion("type",[c.object({type:c.literal("vertical"),value:g,points:c.object({x:g,y:g}).array().max(4).min(1)}),c.object({type:c.literal("horizontal"),value:g,points:c.object({x:g,y:g}).array().max(4).min(1)}),c.object({type:c.literal("linear"),value:c.string().trim().normalize().nonempty().refine(r=>r.split("=").length===2).pipe(c.transform(r=>r.split("="))),points:c.object({x:g,y:g}).array().max(4).min(1)})]),{useAppForm:U}=D({fieldComponents:{NumberTextField:L,ArrayItemAddButton:I,ArrayItemRemoveButton:G,ReflectionEquationTypeInput:J},formComponents:{FormResetButton:Y,FormSubmitButton:V},fieldContext:P,formContext:X}),K=({onSubmit:r})=>{const{AppField:o,AppForm:x,FormResetButton:m,FormSubmitButton:p,Subscribe:b}=U({defaultValues:{type:"horizontal",value:"2",points:[{x:"1",y:"1"}]},validators:{onChange:w},onSubmit:({value:n})=>{const t=w.safeParse(n);t.success&&r(t.data)}});return e.jsxs(h,{spacing:.5,children:[e.jsx(W,{children:e.jsx(x,{children:e.jsx(m,{})})}),e.jsxs(h,{children:[e.jsx(d,{children:"ประเภทของเส้นสะท้อน"}),e.jsx(o,{name:"type",children:n=>e.jsx(n.ReflectionEquationTypeInput,{})})]}),e.jsx(b,{selector:({values:n})=>({values:n}),children:({values:n})=>e.jsxs(u.Fragment,{children:[n.type==="linear"&&e.jsxs(h,{padding:1,spacing:.5,sx:{backgroundColor:({palette:t})=>C(t.primary.main,.08)},children:[e.jsx(d,{children:"สมการเส้นสะท้อน"}),e.jsx(o,{name:"value",children:({state:t,handleBlur:s,handleChange:a})=>e.jsx(H,{fullWidth:!0,placeholder:"y=-x+2",error:t.meta.errors.length>0,value:t.value,onChange:l=>a(l.target.value),onBlur:s,slotProps:{input:{sx:{fontFamily:"monospace"}}}})})]}),n.type==="vertical"&&e.jsxs(h,{padding:1,spacing:.5,sx:{backgroundColor:({palette:t})=>C(t.primary.main,.08)},children:[e.jsx(d,{children:"เส้นสะท้อน (แนวตั้ง)"}),e.jsx(o,{name:"value",children:t=>e.jsx(t.NumberTextField,{})})]}),n.type==="horizontal"&&e.jsxs(h,{padding:1,spacing:.5,sx:{backgroundColor:({palette:t})=>C(t.primary.main,.08)},children:[e.jsx(d,{children:"เส้นสะท้อน (แนวนอน)"}),e.jsx(o,{name:"value",children:t=>e.jsx(t.NumberTextField,{})})]})]})}),e.jsx(h,{children:e.jsx(o,{name:"points",mode:"array",children:n=>e.jsx(u.Fragment,{children:n.state.value.map((t,s)=>e.jsxs(h,{spacing:.5,padding:1,sx:{backgroundColor:({palette:{primary:a}})=>s%2===0?void 0:C(a.light,.08)},children:[e.jsxs(h,{useFlexGap:!0,spacing:.5,direction:"row",justifyContent:"space-between",children:[e.jsx(d,{children:e.jsx(j,{children:`พิกัดที่ ${s+1}`})}),e.jsx(n.ArrayItemRemoveButton,{index:s})]}),e.jsxs(h,{spacing:.5,direction:"row",children:[e.jsx(o,{name:`points[${s}].x`,children:a=>e.jsx(a.NumberTextField,{})}),e.jsx(o,{name:`points[${s}].y`,children:a=>e.jsx(a.NumberTextField,{})})]})]},`translate-point-${s}`))})})}),e.jsxs(W,{sx:{justifyContent:"space-between"},children:[e.jsx(x,{children:e.jsx(p,{})}),e.jsx(o,{name:"points",children:n=>e.jsx(n.ArrayItemAddButton,{})})]})]})},Q=r=>{const{clearGraph:o,desmosRef:x,addLine:m,addPoint:p,addPolygon:b}=O(r),n=u.useCallback((l,i)=>{l.setExpressions([{latex:`T(x,y) = ( 
          (2)(${i}) - x ,
          y
        )`,hidden:!0},{latex:`x=${i}`,color:F.A400,lines:!0,lineStyle:"DASHED",lineWidth:3}])},[]),t=u.useCallback((l,i)=>{l.setExpressions([{latex:`T(x,y) = (
          x , 
          (2)(${i}) - y
        )`,hidden:!0},{latex:`y=${i}`,color:F.A400,lines:!0,lineStyle:"DASHED",lineWidth:3}])},[]),s=u.useCallback((l,i)=>{const[$,y]=i;l.setExpressions([{latex:`G(x,y)=${$}-(${y})`,hidden:!0},{latex:"H_{x}(x) = G(x,0)",hidden:!0},{latex:"H_{y}(y) = G(0,y)",hidden:!0},{latex:"W = H_{x}'(0)",hidden:!0},{latex:"X = H_{y}'(0)",hidden:!0},{latex:"Y = G(0,0)",hidden:!0},{latex:"Z = W^{2} + X^{2}",hidden:!0},{latex:"T(u,v) = (u - 2W(Wu + Xv + Y)/Z , v - 2X(Wu + Xv + Y)/Z )",hidden:!0},{latex:`${$}=${y}`,lines:!0,lineStyle:"DASHED",lineWidth:3,color:F.A400}])},[]);return{plotReflection:u.useCallback(l=>{if(x.current===void 0)return;o();const{points:i,type:$,value:y}=l,v=x.current;switch($){case"horizontal":t(v,y);break;case"linear":s(v,y);break;case"vertical":n(v,y);break}for(const[f,B]of i.entries()){const k=String.fromCharCode(65+f);m([`A_{${f}}`,`B_{${f}}`]),p({index:f,texName:"A",tex:`(${B.x},${B.y})`,label:k,color:T.A400}),p({index:f,texName:"B",tex:`T(
            (A_{${f}}).x, 
            (A_{${f}}).y   
          )`,label:`${k}\\prime`,color:N.A400})}i.length>1&&(b("A",i.length,T.A400),b("B",i.length,N.A400))},[x,m,p,b,o,t,s,n]),desmosRef:x}};function ie(){const[r,o]=u.useState(null),{plotReflection:x,desmosRef:m}=Q("#desmos"),[p,b]=u.useState({});u.useEffect(()=>{if(m.current===void 0)return;const t=m.current;for(let s=0;s<4;s++){const a=t.HelperExpression({latex:`B_{${s}}`});a.observe("listValue",()=>{b(l=>{const i={...l};return i[s]=[...a.listValue],i})})}return()=>t.destroy()},[m]);const n=u.useCallback(t=>{o(t),x(t)},[x]);return e.jsx(Z,{slots:{secondary:e.jsx(E,{sx:{height:"100%"},children:e.jsx("div",{id:"desmos",style:{width:"100%",height:"100%"}})}),primary:e.jsx(E,{variant:"outlined",sx:{height:"100%",padding:2,overflowY:"auto",scrollbarGutter:"stable",scrollbarWidth:"thin"},children:e.jsxs(h,{spacing:2,children:[e.jsx(d,{color:"textPrimary",sx:{"&:hover":{textDecorationLine:"underline"}},children:e.jsx(_,{to:"/",style:{color:"inherit",textDecorationLine:"none"},children:"กลับหน้าแรก"})}),e.jsx(d,{component:"div",variant:"h5",fontWeight:700,children:"(การแปลงทางเรขาคณิต)"}),e.jsx(d,{variant:"h5",component:"div",fontWeight:700,children:"การสะท้อน"}),e.jsx(K,{onSubmit:n}),e.jsx(A,{title:e.jsx(d,{fontWeight:800,children:"ผลลัพท์"}),children:e.jsxs(h,{children:[r===null&&e.jsxs(e.Fragment,{children:[e.jsx(d,{children:"เส้นการสะท้อน: ไม่พร้อมแสดง"}),e.jsx(j,{children:"พิกัดเดิม $\\rightarrow$ พิกัดใหม่: ไม่พร้อมแสดง"})]}),r!==null&&e.jsxs(e.Fragment,{children:[r.type==="horizontal"&&e.jsx(j,{children:`เส้นการสะท้อน: $y=${r.value}$`}),r.type==="vertical"&&e.jsx(j,{children:`เส้นการสะท้อน: $x=${r.value}$`}),r.type==="linear"&&e.jsx(j,{children:`เส้นการสะท้อน: $${r.value}$`}),e.jsx(j,{children:"พิกัดเดิม $\\rightarrow$ พิกัดใหม่:"}),e.jsx(j,{children:`$$
                          \\begin{array}{lll}
                        ${r.points.map(({x:t,y:s},a)=>{const l=String.fromCharCode(a+65),i=`${l}(${t}, ${s})`,$=p[a];if($===void 0)return`${i} &\\rightarrow &${l}^{\\prime}(?,?)`;const[y,v]=$;return`${i} &\\rightarrow &${l}^{\\prime}(${y},${v})`}).join("\\\\")}
                        \\end{array}$$`})]})]})}),e.jsx(A,{title:e.jsx(d,{fontWeight:600,children:"สมบัติการสะท้อน"}),children:e.jsx(d,{children:"ว่าง"})}),e.jsx(A,{title:e.jsx(d,{fontWeight:600,children:"สูตรการสะท้อน"}),children:e.jsx(d,{children:"ว่าง"})}),e.jsx(q,{})]})})}})}export{ie as component};
